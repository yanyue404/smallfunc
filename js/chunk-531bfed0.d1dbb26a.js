(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-531bfed0"],{"0a9c":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAUCAYAAADlep81AAABMElEQVRIS73VPU4DMRCG4XcU5QCUkJaIiiMgSMFVCCAa4BxAEyWcBYqEcAoELVByAIgGrXcTJdqsf1d2tdLK9qPP9ozoGYcId8APXa5lxBcZh16xxy8PwA7KreiQOcqRMQjvCAN55DOHqcLMUPrV/q8F6AnldAXIhNJzeijTFaYM5LkA9VFegN1cqFoy5cbfCMdSfOkFByyY5kA1YjoMZMKbAeVCuTDlqa2NxqS6nKS+Ph9MDWRNKgHli9kKahsVgmkEtYUKxVhBqagYjBMUi4rFeIFCUSkYb5Avams7KCpwVfR8+uNGHXJNsNUp/pBabwrEBCXkrOgmxqprL3tTQDLL9YMSsqI24w06pvWpUaDGO5WQTFJClqSik2kFZJK6ZJ8F92bBDjcy5sP1OGz//wFaq9d6+us+uQAAAABJRU5ErkJggg=="},"1a5d":function(e,t,n){var i={"./404.vue":["8cdb","chunk-80c44b26"],"./clickArea/clickArea.vue":["b522","chunk-307b63f4"],"./form/index.vue":["371d","chunk-3d7002a1"],"./idcard/index.vue":["5584","chunk-1c3e8720"],"./links/index.vue":["bd8f","chunk-b6a8d2ce","chunk-f29bb358"],"./login/index.vue":["9ed6","chunk-1fbc0a52"],"./nested/menu1/index.vue":["e9bc","chunk-2d226cab"],"./nested/menu1/menu1-1/index.vue":["91b3","chunk-2d0e4e1f"],"./nested/menu1/menu1-2/index.vue":["55cd","chunk-2d0c8bf7"],"./nested/menu1/menu1-2/menu1-2-1/index.vue":["6582","chunk-2d0cfaef"],"./nested/menu1/menu1-2/menu1-2-2/index.vue":["b6fb","chunk-2d2104c6"],"./nested/menu1/menu1-3/index.vue":["8d8b","chunk-2d0e944c"],"./nested/menu2/index.vue":["dbb3","chunk-2d229205"],"./qrcode/index.vue":["ea23","chunk-b6a8d2ce","chunk-79f51740"],"./rate/index.vue":["694b"],"./sms/index.vue":["2fb0","chunk-c3551e5e"],"./table/index.vue":["90fe","chunk-2d0e4b0c"],"./tree/index.vue":["69dd","chunk-2d0d0f79"],"./xss/index.vue":["63c6","chunk-7ea79ace","chunk-d34b114e"]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="1a5d",e.exports=a},"390e":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAqCAYAAADvczj0AAAEzUlEQVRoQ+WZW2wUZRSAv7Nbi+AFTPQBTHzRB40v+qSJYVsEgUSijZeCUQMS3Z1ytYokxqirD8Z7kKbtzoqaEESjVSMxoMGKij5AjGmMaRTwgoRWEQUkNGBxjpl/p6Slu/PP7G6oW/+Xptlz+b85/+Wc8wv/syHjlVdbuIAE0xhkl+QZHOIcd8C6mvM4wlqURQHkEYQV4rLe/39cAWuaSQhbUFIjVq7gIaQkx5fjBliXM4ETbAJml9im6yTPfeMCWLPU0cc7wE0lzyShS1xur3lgfYsk3WxEaQ49gBM4ksOtaWBVhAyvAQstt802pjFLsni1DZyhHWVJKKywk8nMkmc5WtOntGZ4DmWVJbI9JLleOjlU0/ewpnkSeNQS2V7qaZQ2fh8uV3NLWh1W4/GMJbJ7gJTk6T9drqaA1WEZHm0W2L0B7C/F5GoGWB0W47HOkh32BbA/lPooNQGsDgtQXkdJhCQWB1AaJM93YStgBLBJvA9zMdPYI1lO/hcqKU3ThPA2Sl3IfP4kyQzp5BvbnA2wZjmbPtYA6WDJ+BVGq7jmUh+zoQ5z8Ex+XB8S2b+AmeLyVZSJFoDTPA88WERhleR5IYqhastoCw14pvKZGGL7GAnm+FVQVP9DwP7FPKWokrBUXDqiGqyGnLZwLR5bUc4NsXecBDdKjk/i+BTNUk8/x0L2iH9U3Cs5Xo1juFxZdbgaz0AUD0DB8N8kaZJOtsT1U4hwhm0ojSH7xEO5W/JsjOsgjrwu5UoG+RS4MGQuJxGaJcd7cWwPyQ4t6csRdqCcH+oI5ovLu+U4sunoEi7jJJ8DU0M/PNwlLm/Y7JX6/dS1pA7X4fERcE6IsUGEJnHZXK7DYnqa5hJgO5i/pUZVttbIe9ihEWWz5WQ8jjBPXLqrAa1pE1Ef9lKLvWWSp71Sn6MyLU0zG2ETyoQQ4wMkmSudZqJlD13ORZzgM+CKUCPCQ+Kaq7PiUTS1VId5eGavnhXi4SgJZkmOneXMQu9nCgNsA66ywD4urikHqzJK5tLqcCvKm6EpnXDIFNgd9MSZTZDCbgWuseg9LXkejmPbJhtaPGiGO4ANoUk7HERoEJdemzP/d21lIgN8OKp3PFp5reRZGcVmHBlrtaQOi/BM0lFaVvjVlGUuu8OcR+gdF9SFl8mREUHjwESRtQKbqDhk8MhZ9tq+oLv/czE50zvupwvlZoudDUxlod9hjAIQVyYSsIHOsBI1FVXY+IkE0yXH/uFCmiVBv+kdz7fAdjGTBdLMP3FBospHBg4iHaWftIuJpOQlfjM6fu/Y4RWUeyywH6DcMvylLypEHLlYwEGkH0N5wjL5b6mjUdr5Q6P0juFjJjBP2jgRZ/LlyMYGDqCfQq3XxdfAF8AKy8fZjjJX8gyUAxBXpyxgA53mRaA1rsPT5HcwhRuGXgUqtBVJvWzgANpvDLRE8jRaqIdJzJA1HC5Tvyy1yoALj1l+63RxLO9Cb9BhPBhLrwrCFQGbKBeunPUod0aaj7CbJCnpMMnKGR8VAxvowhutn3ffZiHYSx3TpYN9Z5w0cFgV4GA/+5VVV8lXeGE/CVLSyY9jBev7rRpwsLz9huD7/jUzAko4EMB+P5awVQc+FekEj6DmVX4y0E2SB8ZyGQ//yP8Ch9ZkOizEgy8AAAAASUVORK5CYII="},"694b":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-conatainer"},[n("el-card",[n("el-steps",{attrs:{active:e.step,simple:""}},[n("el-step",{attrs:{title:"excel导入",icon:"el-icon-upload"}}),n("el-step",{attrs:{title:"配置费率表",icon:"el-icon-edit"}}),n("el-step",{attrs:{title:"完成",icon:"el-icon-s-data"}})],1),n("el-container",[n("el-main",[n("div",{directives:[{name:"show",rawName:"v-show",value:0==e.step,expression:"step == 0"}]},[n("el-upload",{staticClass:"upload-demo",attrs:{drag:"","show-file-list":!1,"before-upload":e.handleFile,accept:".xls,.xlsx",action:"#"}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或"),n("em",[e._v("点击上传")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能导入xls、xlsx文件，下载费率表格模板请"),n("el-link",{attrs:{type:"primary",href:"/tk-online/common/smallfunc/xlsx/template.xlsx"}},[e._v("点击此处"),n("i",{staticClass:"el-icon-download"})])],1)])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step == 1"}],staticClass:"div-step-2"},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("保费维度")])]),n("vuedraggable",{staticClass:"wrapper",attrs:{animation:"300"},model:{value:e.rateConfig.dimensions,callback:function(t){e.$set(e.rateConfig,"dimensions",t)},expression:"rateConfig.dimensions"}},[n("transition-group",e._l(e.rateConfig.dimensions,(function(t,i){return n("div",{key:t.weight,staticClass:"dimention-row"},[n("el-tooltip",{attrs:{content:e.rateConfig.inline===i?"作为列表项展示":"作为筛选项展示",placement:"top"}},[n("el-switch",{attrs:{value:e.rateConfig.inline===i},on:{change:function(t){return e.$set(e.rateConfig,"inline",t?i:"")}}})],1),n("vuedraggable",{staticClass:"wrapper",attrs:{animation:"300",disabled:e.editIndex},model:{value:t.fields,callback:function(n){e.$set(t,"fields",n)},expression:"o.fields"}},[n("transition-group",e._l(t.fields,(function(t,a){return n("div",{key:t.value,staticClass:"dimension-item"},[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.editIndex==i+""+a,expression:"editIndex == index + '' + i"}],staticClass:"dimension-item-input",attrs:{size:"small"},on:{blur:function(t){e.editIndex=""}},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"item.name"}}),n("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.editIndex!=i+""+a,expression:"editIndex != index + '' + i"}],staticClass:"dimension-item-tag",attrs:{color:e.colorList[i%e.colorList.length],effect:"dark"}},[e._v(" "+e._s(t.name)+" "),n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.editIndex=i+""+a}}})])],1)})),0)],1)],1)})),0)],1)],1),1==e.step?n("div",{staticClass:"mobile-wrap"},[n("rate-list")],1):e._e()],1),2==e.step?n("div",{staticClass:"div-step-3"},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("JSON文本")])]),n("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"div-code"},[n("pre",[e._v("                "),n("code",{staticClass:"json"},[e._v(e._s(e.rateConfig))]),e._v("\n              ")])])])],1):e._e()]),n("el-footer",{attrs:{id:"footer"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.step,expression:"step !== 0"}],attrs:{type:"primary"},on:{click:function(t){return e.preStep()}}},[e._v("上一步")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step == 1"}],attrs:{type:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v("下一步")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],attrs:{id:"copy-json","data-clipboard-text":JSON.stringify(e.rateConfig),type:"success"},on:{click:function(t){return e.confirm()}}},[e._v("完成并复制")])],1)],1)],1)],1)},a=[],s=n("c7eb"),o=n("b85c"),r=n("1da1"),c=n("5530"),l=(n("13d5"),n("d3b7"),n("d81d"),n("c740"),n("ddb0"),n("fb6a"),n("a630"),n("3ca3"),n("6062"),n("159b"),n("2f62")),u=n("b76a"),d=n.n(u),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rate-container"},[i("div",{staticClass:"rate-sticky"},[i("div",{staticClass:"rate-tips"},[e._v("温馨提示："+e._s(e.rateConfig.tips))]),i("div",{staticClass:"rate-control"},[e._l(e.filters,(function(t,a){return i("span",{key:a,staticClass:"rate-control-item",on:{click:function(t){return e.showDialog(a)}}},[i("span",[e._v(e._s(e._f("fieldName")(e.unite[a],t.fields)))]),i("img",{attrs:{src:n("0a9c")}})])})),e.isShowDialog?i("div",{staticClass:"rate-dialog"},[e._l(e.filters[e.checkingIndex].fields,(function(t,a){return i("span",{key:a,on:{click:function(t){return e.onSelected(a)}}},[e._v(" "+e._s(t.name)+" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.value==e.unite[e.checkingIndex],expression:"item.value == unite[checkingIndex]"}],attrs:{src:n("390e")}})])})),i("div",{staticClass:"triangle_border_up",style:{left:e.positionX+"%"}})],2):e._e()],2),i("div",{staticClass:"rate-box-top"},[i("span",[e._v("投保年龄")]),e.column?e._l(e.column.fields,(function(t,n){return i("span",{key:n},[e._v(e._s(t.name))])})):i("span",[e._v("保费")])],2)]),i("div",{staticClass:"rate-box",on:{click:function(t){e.isShowDialog=!1}}},e._l(e.range,(function(t){return i("div",{key:t.rowKey,staticClass:"rate-box-item"},[i("span",[e._v(e._s(t.rowKey))]),e._l(t.rowData,(function(t,n){return i("span",{key:n},[e._v(e._s(e._f("formatMoney")(t)))])}))],2)})),0)])},h=[],p=n("2909"),v=(n("b0c0"),n("a434"),n("b64b"),n("4de4"),n("a15b"),n("3835")),m=(n("ac1f"),n("5319"),n("00b4"),n("b680"),n("99af"),n("2ef0"));function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.precision,i=void 0===n?2:n,a=t.symbol,s=void 0===a?"￥":a;if(void 0===e||null===e||""===e||isNaN(e))return"";var o=e<0?"-":"",r=b(Math.abs(e),i).split("."),c=Object(v["a"])(r,2),l=c[0],u=c[1],d=l.length>3?l.length%3:0;return s+o+(d?l.substr(0,d)+",":"")+l.substr(d).replace(/(\d{3})(?=\d)/g,"$1,")+(u?"."+u:"")}function b(e,t){var n=Math.round(Math.abs(t));t=isNaN(n)?2:t;var i=Math.pow(10,t);return(Math.round((e+1e-8)*i)/i).toFixed(t)}var x={name:"RateList",filters:{formatMoney:g,fieldName:function(e,t){var n=t.findIndex((function(t){return t.value==e}));return-1!=n?t[n].name:""}},data:function(){return{schema:"",checkingIndex:0,isShowDialog:!1}},computed:Object(c["a"])(Object(c["a"])({},Object(l["d"])({rateConfig:function(e){return e.rate.rateConfig}})),{},{unite:{get:function(){return this.$store.state.rate.unite},set:function(e){this.$store.commit("rate/updateUnite",e)}},filters:function(){var e=Object(p["a"])(this.rateConfig.dimensions);return""!==this.rateConfig.inline&&e.splice(this.rateConfig.inline,1),e},column:function(){return this.rateConfig.dimensions[this.rateConfig.inline]},dataIndex:function(){var e=this;return this.unite&&0!=this.filters.length?this.unite.split("").reduce((function(t,n,i){return t+n*(e.filters[i]?e.filters[i].weight:0)}),0):0},positionX:function(){return 100*this.checkingIndex/this.filters.length+100/this.filters.length/2},range:function(){var e=this;if(Object(m["isEmpty"])(this.rateConfig.data))return[];for(var t=[],n=Object(m["isEmpty"])(this.column)?[this.dataIndex]:this.column.fields.map((function(t){return e.dataIndex+t.value*e.column.weight})),i=Object.keys(this.rateConfig.data),a=function(){var i=o[s],a=n.map((function(t){return e.rateConfig.data[i][t]})).filter((function(e){return!!e}));a.length>0&&t.push({rowKey:i,rowData:a})},s=0,o=i;s<o.length;s++)a();return t}}),mounted:function(){},methods:{showDialog:function(e){this.isShowDialog=!0,this.checkingIndex=e},onSelected:function(e){this.unite=w(this.unite,this.checkingIndex,this.filters[this.checkingIndex].fields[e].value),this.isShowDialog=!1}}};function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=e.split("");return i[t]=n,i.join("")}var k=x,C=(n("ebb0"),n("2877")),A=Object(C["a"])(k,f,h,!1,null,"0530ffae",null),y=A.exports,j={name:"ImportRate",components:{vuedraggable:d.a,rateList:y},data:function(){return{colorList:["#409eff","#67c23a","#f56c6c","#e6a23c"],editIndex:""}},computed:{rateConfig:{get:function(){return this.$store.state.rate.rateConfig},set:function(e){this.$store.commit("rate/updateRateConfig",e)}},step:{get:function(){return this.$store.state.rate.step},set:function(e){this.$store.commit("rate/updateStep",e)}}},watch:{step:{handler:function(e){this.updateShowMobile(1==e)},immediate:!0}},updated:function(){},mounted:function(){var e=this;this.$cms.context.$on("initRateConfig",(function(t){t?(e.updateStep(1),e.updateRateConfig(t)):e.updateStep(0)}))},methods:Object(c["a"])(Object(c["a"])({},Object(l["c"])({updateShowMobile:"rate/updateShowMobile",updateStep:"rate/updateStep",updateRateConfig:"rate/updateRateConfig"})),{},{handleFile:function(e){var t=this,n=new FileReader;return n.onload=function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(n){var i,a,r,c,l,u,d,f,h,p,v,m;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,i=n.target.result,a=new ExcelJS.Workbook,e.next=5,a.xlsx.load(i);case 5:r=a.worksheets[0],c=r.getRows(0,r.rowCount),l={},u=[],d=!1,f=Object(o["a"])(c);try{for(f.s();!(h=f.n()).done;)p=h.value,v=p.values.findIndex((function(e){return e&&"\n"!=e})),m=p.values.slice(v),-1!=v&&0!=m.length&&(d?l[m[0]]=m.slice(1):(u.push(Array.from(new Set(m))),"投保年龄"===m[0]&&u[u.length-1].shift()&&(d=!0)))}catch(s){f.e(s)}finally{f.f()}u.reverse().reduce((function(e,t,n){return u[n]={weight:e,fields:t.map((function(e,t){return{name:e,value:t}}))},e*t.length}),1),t.rateConfig={dimensions:u.reverse(),data:l},t.nextStep(),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](0),console.log(e.t0),t.$message({message:"模板解析失败",type:"error"});case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(e),Promise.reject()},nextStep:function(){this.step=(this.step+1)%3},confirm:function(){var e=this,t=new ClipboardJS("#copy-json");t.on("success",(function(){e.$message({message:"复制成功"}),t.destroy(),e.$cms.rateConfigDone(e.rateConfig)})),t.on("error",(function(e){console.log(e),t.destroy()}))},preStep:function(){this.step=(this.step-1)%3}})};var S=j,E=(n("aa88"),Object(C["a"])(S,i,a,!1,null,"29936bf7",null));t["default"]=E.exports},"88af":function(e,t,n){},aa88:function(e,t,n){"use strict";n("e5380")},e5380:function(e,t,n){},ebb0:function(e,t,n){"use strict";n("88af")}}]);